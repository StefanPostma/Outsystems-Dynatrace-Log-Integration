{"version":19,"variables":[{"version":2,"key":"Application","type":"query","visible":true,"editable":true,"input":"fetch logs\n| filterOut outsystems.app.name == \"\"\n| sort outsystems.app.name asc\n| summarize collectDistinct(outsystems.app.name)","multiple":true},{"version":2,"key":"Tenant","type":"query","visible":true,"editable":true,"input":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| fieldsAdd strTenant=toString(outsystems.tenant.id)\n| sort strTenant asc\n| summarize collectDistinct(outsystems.tenant.id)","multiple":true},{"version":2,"key":"Environment","type":"query","visible":true,"editable":true,"input":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| fieldsAdd strTenant=toString(deployment.environment)\n| sort strTenant asc\n| summarize collectDistinct(deployment.environment)","multiple":true}],"tiles":{"1":{"title":"","type":"data","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter outsystems.log.type == \"Error\"\n| filter in(outsystems.app.name, $Application) \n| filter in(deployment.environment, $Environment) \n| filter in(outsystems.tenant.id, $Tenant)\n| filter exception.message <> \"\"\n| summarize Count = countDistinct(outsystems.log.uid) ,by:{Application=outsystems.app.name, Tenant=outsystems.tenant.id, Environment=deployment.environment, Pattern=exception.message}\n| sort Count desc\n//| fieldsAdd link = concat(\"https://vqk64763.apps.dynatrace.com/ui/apps/dynatrace.dashboards/dashboard/14beeac5-2016-438d-b14b-0ecf62d1d965//edit/tile/0/main/0,0#vfilter_Environment=\",Environment,\"&vfilter_Application=\",Application,\"&vfilter_Error_Message=\",Pattern)\n| limit 100","visualization":"table","visualizationSettings":{"table":{"columnOrder":["[\"Application\"]","[\"Tenant\"]","[\"Environment\"]","[\"Pattern\"]","[\"Count\"]"]},"thresholds":[],"unitsOverrides":[{"identifier":"Count","unitCategory":"unspecified","baseUnit":"none","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1722349478818}]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"3":{"type":"markdown","content":"### Top Error Pattern Count\n> by Application / Tenant"},"6":{"type":"markdown","content":"#\n### Top Slow Query Requests\n> by Application / Action \n\n> sort by total time (average x number of occurences)"},"7":{"title":"Average duration of slower requests","type":"data","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter outsystems.log.message.tag == \"SLOWSQL\"\n| filter in(outsystems.app.name, $Application)\n| filter in(deployment.environment, $Environment)\n| summarize {\n\t\tcount = count(), \n\t\tmaxDuration = takeMax(toLong(outsystems.request.duration)), \n\t\tavg = avg(toLong(outsystems.request.duration))\n\t}, by:{\n\t\tapplication = outsystems.app.name, \n        tenant = outsystems.tenant.id,\n\t\tmodule = outsystems.log.message.tag, \n\t\taction = outsystems.request.slowquery.query, \n        environment = deployment.environment \n\t}\n| fieldsAdd avgInSec = round(avg / 1000, decimals:2)\n| fieldsAdd ApplicationAction = concat(application, \" | \", action)\n| fields ApplicationAction, count, avg, maxDuration\n| fieldsAdd cpu = avg * count\n// added the below summarize to aggregate the biz events to the selected timeframe (on the top right corner)\n| summarize Count=sum(count), Average=avg(avg), MaxDuration=max(maxDuration), TotalTime=sum(avg * count), by:ApplicationAction\n| sort TotalTime desc\n| limit 10","visualization":"table","visualizationSettings":{"table":{"lineWrapIds":[["label"]]},"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"8":{"title":"Error % per application","type":"data","query":"fetch bizevents //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter event.type == \"outsystems.error.patterns\"\n| filter in(application, $Application) \n| filter in(environment, $Environment) \n| filter in(tenant_name, $Tenant)\n| filter msg.pattern <> \"\"\n| summarize Count = sum(count) ,by:{Application=application}\n| sort Count desc\n| limit 100","visualization":"pieChart","visualizationSettings":{"chartSettings":{"categoricalBarChartSettings":{"valueAxis":"Count","valueAxisLabel":"Count","categoryAxis":"Application","categoryAxisLabel":"Application"}},"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"9":{"title":"Error % per error pattern","type":"data","query":"fetch bizevents //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter event.type == \"outsystems.error.patterns\"\n| filter in(application, $Application) \n| filter in(environment, $Environment) \n| filter in(tenant_name, $Tenant)\n| filter msg.pattern <> \"\"\n| summarize Count = sum(count) ,by:{msg.pattern}\n| sort Count desc\n| limit 100","visualization":"pieChart","visualizationSettings":{"chartSettings":{"categoricalBarChartSettings":{"valueAxis":"Count","valueAxisLabel":"Count","categoryAxis":"msg.pattern","categoryAxisLabel":"msg.pattern"}},"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}},"10":{"title":"Errors % per module","type":"data","query":"fetch bizevents //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter event.type == \"outsystems.error.patterns\"\n| filter in(application, $Application) \n| filter in(environment, $Environment) \n| filter in(tenant_name, $Tenant)\n| filter msg.pattern <> \"\"\n| summarize Count = sum(count) ,by:{module}\n| sort Count desc\n| limit 100","visualization":"pieChart","visualizationSettings":{"chartSettings":{"categoricalBarChartSettings":{"valueAxis":"Count","valueAxisLabel":"Count","categoryAxis":"module","categoryAxisLabel":"module"}},"thresholds":[]},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":100,"defaultSamplingRatio":10,"enableSampling":false},"davis":{}}},"layouts":{"1":{"x":0,"y":2,"w":24,"h":7},"3":{"x":0,"y":0,"w":10,"h":2},"6":{"x":0,"y":9,"w":24,"h":3},"7":{"x":0,"y":12,"w":24,"h":9},"8":{"x":0,"y":21,"w":7,"h":10},"9":{"x":8,"y":21,"w":7,"h":10},"10":{"x":17,"y":21,"w":7,"h":10}},"importedWithCode":false,"settings":{}}